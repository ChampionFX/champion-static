## INSTALL

* $ curl -L https://cpanmin.us | perl - App::cpanminus
* $ cpanm Carton
* $ cd scripts
* $ carton install

## FAQ

### (1) compile.pl usage (require `cd scripts`)

 * build HTMLs by `carton exec perl compile.pl`
 * re-build all HTML by `carton exec perl compile.pl -f`
 * build specified url by `carton exec perl compile.pl -p why-us`

#### Local test

After HTML build, you can run `sudo grunt connect` then visits [https://localhost/en/home.html] for test

#### github.io deploy

* `carton exec perl compile.pl -d`


#### Compile Parameters

* `-f` force to overwrite the existing HTMLs
* `-d` compile for use in gh-pages of a champion-static fork
* `-p pathname` only compile the files having *pathname* in path
* `-b branchname` to compile the changes to sub-folder named br_branchname
* `-vr` to display list of all generated files

### (2) Make translation

#### Setup
* on Mac, install `Homebrew` by `ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"`

* install `GNU gettext` by `brew install gettext`

## Update translations

#### Setup
* Please make sure you have done `npm install`.
* Install `Homebrew` by `ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"`
* Install `Crowdin CLI` by `brew install crowdin` or follow the instructions here: [https://support.crowdin.com/cli-tool/#installation](https://support.crowdin.com/cli-tool/#installation)
* Get [Crowdin API Key](https://crowdin.com/project/champion-static/settings#api) and add this line to your _.bash_profile_: `export CROWDIN_API_KEY2='put API Key here'`<br/>
**IMPORTANT!** This key gives full access to all your Crowdin project data. Treat this just like a password and never push it to any public repo.

#### Update translations
* Simply run `./scripts/update_translations.sh` in root folder of project to do these tasks:<br/>
(It is possible to confirm/skip each task by answering y/n to questions, only first one is mandatory):
  * Check out and update the translations branch
  * Update master and merge into translations
  * Update the source file (messages.pot) and push to Crowdin
  * Download translation files from Crowdin to `src/translations` and update javascript texts `src/javascript/_autogenerated/[LangCode].js`
  * Commit changes and push to origin
  * Open github to submit the PR

## Update sitemap

* List of paths to include in `sitemap.xml` is here: [sitemap.js](sitemap.js)
* Once the paths are updated in the above file, run `./scripts/sitemap.js` or `grunt shell:sitemap` to generate new `sitemap.xml`
